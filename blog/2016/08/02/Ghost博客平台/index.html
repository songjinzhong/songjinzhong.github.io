<!doctype html><html lang="zh-cn"><head><meta http-equiv="Content-Type" content="text/html" charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="author" content="song"><meta name="description" content="建站 Ghost 博客 平台"><title>我的建站路1：Ghost 博客平台 | 渔人</title><link rel="alternate" href="/blog/rss.xml" title="渔人"><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/all.min.css"></head><body><div class="post"><h1 class="overview"><a href="/blog/rss.xml" class="web-feed" title="RSS订阅" target="_blank"></a> <i class="search-icon"></i> <a href="/">渔人</a> <font>» </font><a href="/blog">博客</a> <font>» </font><a href="/blog/archives">归档</a><div class="big-search"><i class="close-icon"></i><div class="search-container"><form class="search-form"><input class="search-input js-search-input" type="text" placeholder="请输入关键字"></form><div class="js-search-results"></div></div></div></h1><div class="post-info"><h1>我的建站路1：Ghost 博客平台</h1><div class="author-info"><p class="author">作者:<a href="/">宋进忠</a></p><p class="date">时间: <span>2016/08/02</span></p><p class="cat-arc"><span>分类: <a href="/blog/categories/建站/">建站</a> </span><span>标签: <a href="/blog/tags/建站/">建站</a> / <a href="/blog/tags/Ghost/">Ghost</a></span></p></div></div><div class="post-markdown"><h3 id="空间和域名"><a href="#空间和域名" class="headerlink" title="空间和域名"></a>空间和域名</h3><p>关于空间和域名，不想说太多，如果你真心想建立一个自己的网站的话，这两个是必须要弄的。</p><p><img class="img-mid" src="http://ww2.sinaimg.cn/mw690/e3dde130gw1f8hk9i2r3hj20zk0nnk3r.jpg" alt="图片来源网上" title="图片来源于网络"></p><p>我的服务器用的腾讯云的服务器，域名用的也是腾讯的，国内做的比较好的还有阿里云（其实我只知道这两家），国外的知道不少，像Godaddy、securedservers、codero等，当然还有一些便宜的可以做带理的vps服务器。</p><p>我的服务器用的系统是Ubuntu Server 14.04 64位，刚买的时候想尝试一下centos，发现用的不习惯，就重装成ubuntu，还是Ubuntu的命令比较习惯。配置是最便宜的，1G内存，1核CPU，20GB的硬盘，只是搭一个简单的个人博客，这些配置就已经足够了。</p><p>至于域名，是用来映射IP的，其实完全可以不用申请域名，通过IP就可以访问到你的网站。人靠衣装，域名可以方便别人记住你的网站。腾讯有它自己的域名解析，还是免费的，顺便也就用了。因为我申请的是国内.cn的域名，天朝的网站都是要审核的，大概花了两个星期的时间吧，提交材料还碰到许多问题，非常麻烦。如果嫌麻烦可以直接买国外的域名，简单方便，最好支持支付宝就好了，不要让支付成为累赘。</p><p>到此，建站的三大要素都有了，服务器，域名和域名解析。关于域名解析，因为是第一次用，感觉挺有意思的，不过我自己吃过亏，在解析的时候。下面这个图是我的域名解析信息：</p><p><img src="/content/images/2016/08/----.png" alt=""></p><p>我的域名是songjz.cn，主机记录www表示当访问www.songjz.cn的时候指向的ip，*表示匹配所有*.songjz.cn，@表示匹配songjz.cn，具体如下图</p><p><img src="/content/images/2016/08/----2-1.png" alt=""></p><h3 id="Ghost-开源的博客平台"><a href="#Ghost-开源的博客平台" class="headerlink" title="Ghost 开源的博客平台"></a>Ghost 开源的博客平台</h3><p>下面就是安装Ghost了，现在还需要连接服务器的两个工具<code>Xshell</code>和<code>Xftp</code>，都是免费的。</p><p>通过Xshell连接到Ubuntu服务器，update后先安装<code>nodejs</code>：</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><code class="elixir">root<span class="variable">@server1</span><span class="symbol">:~</span><span class="comment"># sudo apt-get update</span>
root<span class="variable">@server1</span><span class="symbol">:~</span><span class="comment"># sudo apt-get install nodejs</span></code></pre></td></tr></table></figure><p>安装nodejs的同时，也会把npm也一起安装：</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><code class="elixir">root<span class="variable">@server1</span><span class="symbol">:~</span><span class="comment"># node -v</span>
v4.<span class="number">4.7</span>
root<span class="variable">@server1</span><span class="symbol">:~</span><span class="comment"># npm -v</span>
<span class="number">1.3</span>.<span class="number">10</span></code></pre></td></tr></table></figure><p>下面开始安装Ghost，通过<a href="https://ghost.org/developers/">Ghost下载界面</a>下载最新版，通过Xftp把文件上传到服务器的自定义位置。（如果没有高级root权限，建议放到当前用户的目录下，防止权限不足问题）</p><p>通过<code>unzip</code>或<code>tar</code>解压刚才的文件（这要看下载的文件是.zip还是.tar.gz），然后执行：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><code class="sql">cd ghost
npm <span class="keyword">install</span> <span class="comment">--production</span></code></pre></td></tr></table></figure><p>Ghost博客需要的库较多，需要安装一会。</p><p>复制一份config.example.js为config.js，用vim打开：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><code class="css"><span class="selector-tag">production</span>: &#123;
    <span class="attribute">url</span>: <span class="string">'http://blog.songjz.cn'</span>,
	//将上面url修改为自己的博客主页
    mail: &#123;&#125;,
    <span class="selector-tag">database</span>: &#123;
        <span class="attribute">client</span>: <span class="string">'sqlite3'</span>,
        connection: &#123;
            filename: path.<span class="built_in">join</span>(__dirname, <span class="string">'/content/data/ghost.db'</span>)
        &#125;,
        <span class="selector-tag">debug</span>: <span class="selector-tag">false</span>
    &#125;,
    <span class="selector-tag">server</span>: &#123;
        <span class="attribute">host</span>: <span class="string">'127.0.0.1'</span>,
		//host修改成<span class="string">'0.0.0.0'</span>
        port: <span class="string">'2368'</span>
		//运行的端口，把端口设置成<span class="string">'80'</span>
    &#125;
&#125;,</code></pre></td></tr></table></figure><p>基本配置完成，然后：</p><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><code class="oxygene">root@server1:~# node <span class="keyword">index</span>.js
WARNING: Ghost <span class="keyword">is</span> attempting <span class="keyword">to</span> use a direct <span class="function"><span class="keyword">method</span> <span class="title">to</span> <span class="title">send</span> <span class="title">email</span>.
<span class="title">It</span> <span class="title">is</span> <span class="title">recommended</span> <span class="title">that</span> <span class="title">you</span> <span class="title">explicitly</span> <span class="title">configure</span> <span class="title">an</span> <span class="title">email</span> <span class="title">service</span>.
<span class="title">Help</span> <span class="title">and</span> <span class="title">documentation</span> <span class="title">can</span> <span class="title">be</span> <span class="title">found</span> <span class="title">at</span> <span class="title">http</span>:</span><span class="comment">//support.ghost.org/mail.</span>

Migrations: Up-<span class="keyword">to</span>-date at version <span class="number">004</span>
Ghost <span class="keyword">is</span> running <span class="keyword">in</span> development...
Listening <span class="keyword">on</span> <span class="number">0.0</span>.<span class="number">0.0</span>:<span class="number">80</span>
Url configured <span class="keyword">as</span>: http:<span class="comment">//blog.songjz.cn</span>
Ctrl+C <span class="keyword">to</span> shut down</code></pre></td></tr></table></figure><p>报了一个warning，是因为没有配置邮件。实际上Ghost是一个多人博客平台，通过邮件邀请他人一起写博客，这个先不管。</p><p>这个时候就可以通过浏览器访问主页了，如果域名和解析暂时无法使用的时候，也可以通过主机的ip来直接访问。比如<a href="http://115.159.219.205。">http://115.159.219.205。</a></p><h3 id="Forever和Nginx"><a href="#Forever和Nginx" class="headerlink" title="Forever和Nginx"></a>Forever和Nginx</h3><p>这个时候通过ctrl+c或关闭Xshell，Ghost的运行就会停止，如何让Ghost后台运行？</p><p>Forever是一个简单的命令式nodejs的守护进程，创建、自动重启node进程，输出node日志，还可以同时开启多个node进程,可以通过<code>forever start</code>启动进程，<code>forever stop</code>关闭进程，<code>forever list</code>查看当前运行的进程列表：</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><code class="livecodeserver">npm install -g <span class="keyword">forever</span>
<span class="keyword">forever</span> <span class="built_in">start</span> index.js
<span class="keyword">forever</span> list</code></pre></td></tr></table></figure><p>Nginx 是一个高性能的HTTP和反向代理服务器，以它的稳定性、丰富的功能集、示例配置文件和低系统资源的消耗而闻名。</p><p>所谓的反向代理，就是通过不同的域名映射到同一个ip，比如songjz.cn的域名只能对应一个115.159.219.205ip地址，而浏览器输入一般都是默认访问80端口，所以我输入www.songjz.cn和blog.songjz.cn都是访问服务器的80端口。</p><p>那么我想要输入www.songjz.cn的时候跳转到我的主页，输入blog.songjz.cn跳转到我博客的主页，其实也可以通过URL解析来实现，例如访问博客页www.songjz.cn/blog。</p><p>现在有一个问题，Ghost是一个独立的nodejs应用，想要通过URL解析很难实现，而nginx的反向代理就可以很轻松实现。原理是先通过80端口访问nginx，nginx判断不同的三级域名，转给其它端口。</p><p><a href="http://nginx.org/en/download.html">nginx的下载页面</a>我用的是1.81的稳定版本。</p><p>将nginx安装包通过Xftp复制到服务器中，解压到/usr/local目录下:</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><code class="vim"><span class="keyword">cd</span> nginx
./configure
<span class="keyword">make</span></code></pre></td></tr></table></figure><p>打开conf/nginx.conf，修改配置：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><code class="nginx"><span class="section">http</span> &#123;
	<span class="attribute">include</span>       mime.types;
	<span class="attribute">default_type</span>  application/octet-stream;
	<span class="attribute">sendfile</span>        <span class="literal">on</span>;
	<span class="attribute">keepalive_timeout</span>  <span class="number">65</span>;
	<span class="comment">#pool</span>
	<span class="attribute">upstream</span> blog_pool&#123;
		<span class="attribute">server</span> <span class="number">127.0.0.1:5000</span>;<span class="comment">#这边开启端口5000</span>
	&#125;
	<span class="section">server</span> &#123;
		<span class="attribute">listen</span>       <span class="number">80</span>;
		<span class="attribute">server_name</span>  blog.songjz.cn;
		<span class="comment">#这句话就是把浏览器打开blog.songjz.cn提交给其它端口</span>
		<span class="attribute">location</span> / &#123;
			<span class="attribute">proxy_set_header</span> Host <span class="variable">$host</span>;
			<span class="attribute">proxy_set_header</span> X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;
			<span class="attribute">proxy_pass</span> http://blog_pool;
			<span class="comment">#调用前面建好的pool</span>
		&#125;
	&#125;</code></pre></td></tr></table></figure><p>增加nginx的环境变量，通过：</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><code class="arduino">nginx
<span class="comment">//开启nginx</span>
nginx -s <span class="built_in">stop</span>
<span class="comment">//关闭nginx</span></code></pre></td></tr></table></figure><p>这个时候再回到Ghost的目录下，把config.js开启端口设置成5000，重启Ghost，通过blog.songjz.cn就可以访问Ghost的主页。</p></div><div class="pre-next clear"><div class="pre-page"><i class="pre-icon"></i> <a href="/blog/2016/08/03/err-incomplete-chunked-encoding/">解决服务器 err incomplete chunked encoding 问题</a></div><div class="next-page"><a href="/blog/2016/08/01/chunked数据错位问题/">处理 Http 协议中的 chunked 数据错位问题</a> <i class="next-icon"></i></div></div><div class="post-footer"><a href="/blog/rss.xml" class="post-feed" target="_black">Feed <i class="feed-icon"></i></a><h3>文档信息</h3><ul><li><span>版权声明：</span><span>自由转载-非商用-保持署名</span><a href="https://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh">(创意共享3.0许可证)</a></li><li><span>发表日期：</span><span>2016-08-02 22:53:23</span></li><li><span>本文分类：</span><span> <a href="/blog/categories/建站/">建站</a></span></li><li><span>本文标签：</span><span> <a href="/blog/tags/建站/">建站</a> / <a href="/blog/tags/Ghost/">Ghost</a></span></li><li><span>最后编辑：</span><span>2016-10-05 18:19:46</span></li><li><span>社交媒体：</span><span><a href="https://github.com/songjinzhong">GitHub<i class="github"></i></a><a href="http://weibo.com/3822969136">微博<i class="weibo"></i></a></span></li><li><span>分享文章：</span> <span><div class="ds-share" data-thread-key="blog/2016/08/02/Ghost博客平台/" data-title="我的建站路1：Ghost 博客平台" data-images="" data-content="空间和域名关于空间和域名，不想说太多，如果你真心想建立一个自己的网站的话，这两个是必须要弄的。我的服务器用的腾讯云的服务器，域名用的也是腾讯的，国内做的比较好的还有阿里云（其实我只知道这两家），国外的知道不少，像Godaddy、sec..." data-url="http://yuren.space/blog/2016/08/02/Ghost博客平台/"><div class="ds-share-inline"><ul class="ds-share-icons-16"><li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li><li><a class="ds-qzone" href="javascript:void(0);" data-service="qzone">QQ空间</a></li><li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li></ul><div class="ds-share-icons-more"></div></div></div></span></li></ul></div><div class="page-related"><h2>相关文章</h2><ul><li><span>2016.09.07</span><a href="/blog/2016/09/07/腾讯404公益页面/">腾讯404公益页面，你中招了吗</a><p>之前在别人的博客里看到了腾讯的 404 公益页面，感觉很不错，算是腾讯的良...</p></li><li><span>2016.08.13</span><a href="/blog/2016/08/13/进度条和统计汉字/">我的建站路5：增加进度条和统计汉字个数</a><p>先看一下效果吧，这是我博客中的例子：图1图2先是统计本文的字数，估计一个大...</p></li><li><span>2016.08.12</span><a href="/blog/2016/08/12/lunrjs的中文支持/">我的建站路4：解决 lunr.js 的中文支持问题</a><p>之前已经说过了，还没有为博客添加搜索功能，实际上，这个功能早已经实现了，只...</p></li><li><span>2016.08.07</span><a href="/blog/2016/08/07/为博客增加一些实用功能/">我的建站路3：为博客增加一些实用功能</a><p>现的情况就是，博客已经基本能用了，黑色简约的风格，给人直观的感受就是：低调...</p></li></ul></div><div class="duoshuo-part" id="comments"><div class="ds-thread" data-thread-key="blog/2016/08/02/Ghost博客平台/" data-title="我的建站路1：Ghost 博客平台" data-url="http://yuren.space/blog/2016/08/02/Ghost博客平台/"></div><style type="text/css">.ds-sync{white-space:normal}.ds-post{transition:all .3s!important}.ds-post:hover{transition:all .3s!important;border-radius:5px!important;background:#F3F3F3!important}#ds-thread #ds-reset .ds-comments{border-bottom:none;padding:15px 0}#ds-thread #ds-reset .ds-powered-by{display:none}.ds-thread .ds-loading{padding:20px 0;text-align:center;color:#AFAFAF;background-color:#EFEFEF;border-radius:5px;line-height:30px;font-style:15px}#ds-thread .ds-loading{display:none;height:0;visibility:hidden}#ds-thread #ds-reset .ds-comments{border-bottom:none}#ds-thread #ds-reset a:hover,.ds-like-panel{color:#999}#ds-reset .ds-avatar,#ds-reset .ds-avatar img{border-radius:100%}#ds-thread #ds-reset li.ds-post{border-top:none}div#ds-thread #ds-reset .ds-comment-body p{color:#000}#ds-thread #ds-reset .ds-comment-body a{color:#777!important}#ds-thread #ds-reset li.ds-tab a{text-shadow:none}#ds-thread #ds-reset .ds-sort a.ds-current,#ds-thread #ds-reset .ds-sort a:active{color:#e58c7c}#ds-thread #ds-reset .ds-post-self{border-top:none}.ds-thread-like-text{display:block}.ds-thread-cancel-like{display:none}.ds-thread-liked .ds-thread-like-text{display:none}.ds-thread-liked .ds-thread-cancel-like{display:block}#ds-thread #ds-reset img{transition:all .3s}#ds-thread #ds-reset img:hover{transform:rotate(180deg);transition:all .3s}div#ds-thread #ds-reset .ds-comment-body{color:#555}#ds-thread #ds-reset .ds-comment-body a[data-user-id='6314610027441160961']::after{content:"博主";border:1px solid #e58c7c;border-radius:2px;margin-left:4px;color:#e58c7c;padding:0 2px;font-size:12px;line-height:14px;display:inline-block}.ds-post-reply,.ds-post-repost{display:none}.ds-post-self:hover .ds-post-reply,.ds-post-self:hover .ds-post-repost{display:inline}.ds-user-name{font-size:14px!important;line-height:42px!important}.ds-children .ds-user-name{line-height:26px!important}div#ds-thread #ds-reset .ds-comment-body p{font-size:16px!important}div#ds-thread #ds-reset .ds-comment-header .ds-user-name{font-size:18px!important;font-family:consolas!important;line-height:30px!important}div#ds-thread #ds-reset .ds-textarea-wrapper textarea{height:120px!important;font-size:16px!important;font-family:Consolas,Georgia,serif}@media (max-width:800px){div#ds-thread #ds-reset .ds-textarea-wrapper textarea{height:70px!important}}div#ds-thread #ds-reset .ds-post-options{overflow:hidden}div#ds-thread #ds-reset .ds-post-toolbar{box-shadow:none}div#ds-thread #ds-reset .ds-post-button{position:relative;margin-top:20px;font-size:16px}div#ds-thread #ds-reset .ds-post-options{margin-right:0!important;border-right:1px solid #CCC}@media screen and (max-width:641px){div#ds-thread #ds-reset .ds-replybox{padding:0!important}div#ds-thread #ds-reset .ds-replybox .ds-avatar{display:none!important}.ds-post-self:hover .ds-post-reply,.ds-post-self:hover .ds-post-report,.ds-post-self:hover .ds-post-repost{display:none!important}}div#ds-thread #ds-reset .ds-comment-body p{white-space:pre-wrap;font-family:consolas!important}#ds-thread #ds-reset .ds-paginator a{font-size:20px!important}#ds-thread #ds-reset .ds-login-buttons p{color:#999}#ds-thread #ds-reset .ds-comment-body{background:#fbfbfb;padding:15px 15px 12px 32px;border-radius:5px;box-shadow:0 1px 2px rgba(0,0,0,.15),0 1px 0 rgba(255,255,255,.75) inset}</style><script type="text/javascript">var duoshuoQuery={short_name:"songjz"};!function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=("https:"==document.location.protocol?"https:":"http:")+"//static.duoshuo.com/embed.js",t.charset="UTF-8",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(t)}()</script></div><div class="web-info">Copyright © 2016-2017,本站由 <a href="/blog/web-info">本人</a> 手工打造,历时2周, <a href="/blog/web-info/#link">联系方式</a> <span>网站参考 <a href="http://www.barretlee.com/">小胡子哥</a>/ <a href="http://www.ruanyifeng.com/home.html">阮一峰老师</a></span></div></div><div class="tools"><i class="back-to-top" style="display:none"></i> <i class="goto-comments"></i></div><script src="/js/jquery-3.1.0.min.js"></script><script src="/js/all.min.js"></script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="//hm.baidu.com/hm.js?513bc3e28555252418b03cc8e660bc31";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script>!function(e,t,a,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=t.createElement(a),s=t.getElementsByTagName(a)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-85346637-1","auto"),ga("send","pageview")</script></body></html>